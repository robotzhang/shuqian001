<% views = @comment.commentable.class.to_s.downcase.pluralize; %>

<% if @comment.errors.any? %>
    $('#new_comment').replaceWith($('<%= j render :partial => views + '/comments_form', :locals => {:comment => @comment} %>'));
<% else %>
    $('#comments').append($('<%= j render partial: views + "/comments_item", locals: {comment: @comment} %>'));
    $('#new_comment')[0].reset();
<% end %>