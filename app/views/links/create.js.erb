<% if @link.errors.any? %>
$('#new_link').replaceWith('<%= j render :partial => "links/form", locals: { link: @link } %>');
<% else %>
var item = $('<%= j render :partial => "links/item", locals: { link: @link } %>');
<% if @link.link_group.blank? %>
    var container = $(".group:last").find(".links");
<% else %>
    var container = $("#link_group_<%=@link.link_group_id%>").parents(".group").find(".links");
<% end %>

item.appendTo(container);

$('#new_link .alert-error').remove();
$('#new_link')[0].reset();
<% end %>